## bitCode
### 什么是bitCode

```
bitCode是一种在LLVM编译器下产生的中间码,
目的是为了应对不同平台的CPU指令集,
如果打开了xcode的bitCode构建选项,LLVM在编译OC或者Swift时将会产生bitCode,
再通过bitCode去生成对应机器的机器指令
```

### Swift 是克里斯在 LLVM 和 Clang 之后第三个伟大的项目
* LLVM 是什么 (一个伟大的项目)

``` 
Low Level Virtual Machine, LLVM是一个编译器的基础建设,目前作为苹果平台的编译器后端使用
```
 
* 背景故事

``` 
LLVM是苹果目前使用的最新的编译环境,在使用LLVM之前苹果使用的是GCC编译器,
GCC编译器是在GUN平台上最常用的编译器,所以GCC也称为GNU编译器套装.
由于早期的GCC对objective-c的支持不甚友好,所以,苹果公司,开始大力推进LLVM来进行代码编译
```

* Clang 是什么 (一个伟大的项目)

```
Clang是编译器前端,提供 C、C++、Objective-C和Objective-C++编程语言的编译器前端,
由于有了LLVM这种强大,可以处理多种语言的编译器后端,所以苹果开发了对于自己技术栈,更加友好的
编译器前端,在mac os平台下,可以使用Clang命令将OC或者Swift代码转换为C语言的源码
```
所以在近几年的iOS演化过程中,xcode的编译器经历了从 gcc 到 LLVM 的过度 ```gcc -> llvm```

### 编译器前端/后端
要理解编译器的前后端,首先需要理解常规的编译过程
编译器粗略的分为

* 词法分析
* 语法分析
* 类型检查
* 中间代码生成
* 代码优化
* 目标代码生成
* 目标代码优化

在中间代码生成的步骤之前,编译器的逻辑处理,统一称之为编译器前端之后的称之为编译器后端

* 编译器前端: ```不管你是什么语言,我都转化为中间件 --> clang```

* 编译器后端: ```只要你给我中间件,我都可以转为与需要平台的指令 --> llvm```


### 带有bitCode处理的编译逻辑
可以粗暴的理解为

```
swift,objective-c,c,c++  => 
clang => (通过Clang,将代码转为中间码)
bitcode => 
llvm => (通过中奖码,将代码转化为机器指令)
CPUCode => 
CPU => 
just do it
```
应对不同平台CPU,如果存在bitcode可以根据bitcode,生成对应的机器码指令

### 没有进行bitCode处理的情况

对于没有bitcode的处理: ```Universal Binary```

```
一次生成多个可执行指令集
影响就是同一个文件中存了多份可执行代码,除了当前机器可执行的那一份之外其他都是无用的.
白占空间,操作系统运行时根据处理器类型动态选择正确的二进制版本来运行.
应用程序要支持不同平台的处理器的话,应用程序本身要多占用一些空间.
也有一些瘦身的工具,比如lipo,
可以用来移除fat binary中那些当前机器中不被支持的或者多余的可执行代码达到瘦身目的
```
### 总结

* bitcode: ```编译过程中的中间代码```

* LLVM的编译工作原理: 

```
编译器前端负责把项目程序源代码翻译成Bitcode中间码,
然后再根据不同目标机器芯片平台转换为相应的汇编指令以及翻译为机器码
```
后续将会继续研究更加深入的编译过程
